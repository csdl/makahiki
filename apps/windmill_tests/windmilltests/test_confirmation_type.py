# Generated by the windmill services transformer
from windmill.authoring import WindmillTestClient
import datetime

def test_confirmation_type():
    client = WindmillTestClient(__name__)

    client.open(url=u'http://localhost:8000/account/login/')
    client.waits.forPageLoad(timeout=u'20000')
    client.type(text=u'admin', id=u'id_username')
    client.type(text=u'changeme', id=u'id_password')
    client.click(value=u'Log in \xbb')
    client.waits.forPageLoad(timeout=u'20000')
    client.waits.forElement(link=u'Admin', timeout=u'8000')
    client.click(link=u'Admin')
    client.waits.forPageLoad(timeout=u'20000')
    client.waits.forElement(link=u'Activitys', timeout=u'8000')
    client.click(link=u'Activitys')
    client.waits.forPageLoad(timeout=u'20000')
    client.waits.forElement(link=u'Add activity', timeout=u'8000')
    client.click(link=u'Add activity')
    client.waits.forPageLoad(timeout=u'20000')
    client.type(text=u'Attend Blue Planet Foundation Meeting', id=u'id_title')
    client.type(text=u'Attend a meeting held by the Blue Planet Foundation', id=u'id_description')
    client.type(text=u'10', id=u'id_point_value')
    client.type(text=u'60', id=u'id_duration')
    
    # Need to check the current day.
    date = datetime.date.today()
    date.replace(day=date.day+10)
    client.click(id=u'id_expire_date')
    client.type(text=date.isoformat(), id=u'id_expire_date')
    
    client.click(id=u'id_confirm_type')
    client.select(option=u'', id=u'id_confirm_type')
    client.click(value=u'code')
    client.check(id=u'id_is_event')
    client.click(xpath=u"//form[@id='activity_form']/div/fieldset/div[10]/div/p[1]/span[1]/a[1]")
    client.click(link=u'Now')
    client.click(name=u'_save')
    client.waits.forPageLoad(timeout=u'20000')
    client.asserts.assertText(validator=u'This confirmation type requires a confirmation prompt.', id=u"//form[@id='activity_form']/div/fieldset/div[8]/ul/li")
    client.click(xpath=u"//form[@id='activity_form']/div/fieldset/div[8]/div")
    client.click(id=u'id_confirm_prompt')
    client.type(text=u'Enter ticket code provided at meeting.', id=u'id_confirm_prompt')
    client.click(name=u'_save')
    client.waits.forPageLoad(timeout=u'20000')
    client.asserts.assertText(xpath=u"//div[@id='container']/ul/li", validator=u'The activity "Attend Blue Planet Foundation Meeting" was added successfully.')
    client.click(link=u'Attend Blue Planet Foundation Meeting')
    client.waits.forPageLoad(timeout=u'20000')
    client.waits.forElement(link=u'Delete', timeout=u'8000')
    client.click(link=u'Delete')
    client.waits.forPageLoad(timeout=u'20000')
    client.waits.forElement(timeout=u'8000', value=u"Yes, I'm sure")
    client.click(value=u"Yes, I'm sure")
    client.waits.forPageLoad(timeout=u'20000')
    client.asserts.assertText(xpath=u"//div[@id='container']/ul/li", validator=u'The activity "Attend Blue Planet Foundation Meeting" was deleted successfully.')
    client.click(link=u'Log out')
    client.waits.forPageLoad(timeout=u'20000')
    client.asserts.assertNode(link=u'Log in again')