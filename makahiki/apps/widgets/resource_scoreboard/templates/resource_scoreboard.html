<div class="content-box">
{% if not no_carousel %}
    <div id="score-carousel" class="carousel">
    <div class="carousel-inner">
    {% endif %}
    {% for round_name, ranks in round_resource_ranks.items %}
        <div class="item {% if forloop.first %}active{% endif %}">
            <div class="content-box-title">
                {{ round_name }} {{ resource.name|capfirst }} Score Board
                {% if not no_carousel %}
                    <a href="#" style="float: right">
                        <img src="{{ STATIC_URL}}images/icons/icon-help-sm.png" width="20"
                         align="center"
                         title="Click to get help about this window"
                         onclick="toggleHelp('widget', 'resource-scoreboard'); return false;"/>
                    </a>
                {% endif %}
            </div> 
                <table class="table-striped">
                    <tr>
                        <th>Rank</th>
                        <th>{{ TEAM_LABEL }}</th>
                        <th>{{ resource.unit  }} used</th>
                    </tr>
                    {% for entry in ranks %}
                    <tr>
                        <td>{%  if entry.team__name == user.get_profile.team.name %}<b>{% endif %}
                               {{ forloop.counter }}
                        </td>
                        <td>{%  if entry.team__name == user.get_profile.team.name %}<b>{% endif %}
                               {{ entry.team__name }}
                        </td>
                        <td>
                               {%  if entry.team__name == user.get_profile.team.name %}<b>{% endif %}
                               {{ entry.total }}
                        </td>
                    </tr>
                    {% endfor %}
                </table>
        </div>
    {% endfor %}
    {# Additional scoreboard entry for the energy goals #}
    {% if goals_scoreboard and goals_scoreboard|length > 0 %}
        <div class="item">
            <div class="content-box-title">
                Completed Energy Goals
                {% if not no_carousel %}
                    <a href="#" style="float: right">
                        <img src="{{ STATIC_URL}}images/icons/icon-help-sm.png" width="20"
                         align="center"
                         title="Click to get help about this window"
                         onclick="toggleHelp('widget', 'resource-scoreboard'); return false;"/>
                    </a>
                {% endif %}
            </div>
            <div>
                <table class="table-striped">
                    <tr>
                        <th>Rank</th>
                        <th>{{ TEAM_LABEL }}</th>
                        <th>Days met goal</th>
                    </tr>
                    {% for entry in goals_scoreboard %}
                        <tr>
                            <td>{{ forloop.counter }}</td>
                            <td>
                                {{ entry.team__name }}
                            </td>
                            <td>{{ entry.completions }}</td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
        </div>
    {% endif %}
    {% if not no_carousel %}
    </div>
    </div>
    <div id="resource-scoreboard-message">
    <center>#1 at end of round wins a
      <a href="/prizes"> prize!</a>
    </center>
    </div>
    {% endif %}
</div>
{% if not no_carousel %}
<script type="text/javascript">
    $(document).ready(function () {
          // Calculate the height of the items in the scoreboard.
          // Fix the height of all items to that height.
          var maxHeight = 45;
          var height = 0;
          $("#score-carousel .item").each(function(index, item) {
            height = $(item).height();
            // console.log("height of item is " + height);
            if (height > maxHeight){
              maxHeight = height;
            }
          });
          maxHeight += $("#resource-scoreboard-message").height();        
          $("#score-carousel").height(maxHeight);

        $("#score-carousel").carousel();
    });
{% endif %}
</script>