{% load notice_tags %}
<div id="notification-dialog" title="Notifications" style="display: none">
    <ul id="notification-dialog-list">
        {% for notification in notifications.alerts %}
            <li id="notification-dialog-{{notification.id}}"
                class="{{notification.style_class}} notification-item">
                <!-- FIXME: Don't like the width 530px -->
                <div class="notification-contents"
                     {% if notification.is_success %}style="width: 530px"{% endif %}>
                    <span class="notice-icon ui-icon {{notification.icon_class}}"></span>
                    <!--  FIXME: Don't like the width 600px -->
                    <div class='notice-content' {% if notification.is_success %}style="width: 470px"
                         {% else %}style="width: 600px"{% endif %}>
                        {{ notification.contents|safe }}
                    </div>
                </div>
                {% if notification.is_success %}
                    <div class="notification-options">
                        <a class="notification-share" href="javascript:void(0);">Share on
                            Facebook</a>&nbsp;
                    </div>
                {% endif %}
                <br style="clear: both"/>
            </li>
            <script type="text/javascript">
                jQuery(document).ready(function ($) {
                    $("#notification-dialog-{{notification.id}} .notification-share").unbind("click").click(function (event) {
                        FB.ui(
                                {
                                    method:'feed',
                                    name:'Kukui Cup',
                                    link:'http://{{request.META.HTTP_HOST}}',
                                    picture:'http://{{request.META.HTTP_HOST}}{{STATIC_URL}}images/logo.png',
                                    description:'{{notification.contents}}',
                                    display:'popup'
                                }
                        );
                        return false;
                    });
                });
             </script>
        {% endfor %}
    </ul>
    <center>
        <button>OK</button>
    </center>
</div>
<div id="notificationModal" class="modal hide fade">
    <div class="modal-header">
        <a class="close" data-dismiss="modal">x</a>
        <h3>Notifications</h3>
    </div>
    <div class="modal-body" id="modal-body">
        <ul id="notification-dialog-list">
            {% for notification in notifications.alerts %}
                <li id="notification-dialog-{{notification.id}}"
                    class="{{notification.style_class}} notification-item">
                    <div class="notification-contents">
                        <div class='notice-icon'>
                            <span class="ui-icon {{notification.icon_class}}"></span>
                        </div>
                        <div class='notice-content'>
                            {{ notification.contents|safe }}
                        </div>
                    </div>
                    {% if notification.is_success %}
                    <div class="notification-options">
                        <a class="notification-share" href="javascript:void(0);">Share on
                            Facebook</a>&nbsp;
                    </div>
                    {% endif %}
                </li>
                <script type="text/javascript">
                    jQuery(document).ready(function ($) {
                        $("#notification-dialog-{{notification.id}} .notification-share").unbind("click").click(function (event) {
                            FB.ui(
                                    {
                                        method:'feed',
                                        name:'Kukui Cup',
                                        link:'http://{{request.META.HTTP_HOST}}',
                                        picture:'http://{{request.META.HTTP_HOST}}{{STATIC_URL}}images/logo.png',
                                        description:'{{notification.contents}}',
                                        display:'popup'
                                    }
                            );
                            return false;
                        });
                    });
                </script>
            {% endfor %}
        </ul>
    </div>
    <div class="modal-footer">
        <a href="#" class="btn" data-dismiss="modal">OK</a>
    </div>

</div>
<script type="text/javascript">
    $(document).ready(function () {
//         $("#notification-dialog").dialog({
//             modal:true,
//             width:700,
//             closeOnEscape:false,
//             position:["center", 150]
//         });

        $('#notificationModal').modal({
            backdrop: true,
            keyboard: true,
            show: false
        }); 

        // set up event logging
        $('#notificationModal').on('shown', function() {
            log_js_action("notifications", "alert", 'view-lock-open');
        });
        $('#notificationModal').on('hidden', function() {
            log_js_action("notifications", "alert", 'view-lock-close');
        });
        $('#notificationModal').modal('show');
        
//         $("#notification-dialog button").click(function () {
//             log_js_action("notifications", "alert", "close");
//             $("#notification-dialog").dialog("close");
//         });
    });
</script>

{% mark_alerts_displayed request notifications.alerts %}