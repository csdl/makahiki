<div class="content-box">
    <div class="content-box-title">
        {{ view_objects.scoreboard.current_round }} Point Scoreboard
        {% if not view_objects.scoreboard.no_carousel %}
            <a href="#" style="float: right">
                <img src="{{ STATIC_URL}}images/icons/icon-help-sm.png"
                    width="20" align="center"
                    title="Click to get help about this window"
                    onclick="toggleHelp('widget', 'points-scoreboard'); return false;" />
            </a>
        {% endif %}
    </div>
    <div class="row-fluid">
        {% if not view_objects.scoreboard.no_carousel %}
        <div id="score-carousel" class="span12 carousel">
            <div class="carousel-inner">
        {% endif %}
                <div class="item active">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>{{ TEAM_LABEL.capitalize }}</th>
                                <th>Overall</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for f in view_objects.scoreboard.team_standings %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ f.profile__team__name }}</td>
                                <td>{{ f.points }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="item">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Individual</th>
                                <th>Overall</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for p in view_objects.scoreboard.profile_standings %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ p.profile__name }}</td>
                                <td>{{ p.points }}</td>
                            </tr> 
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="item">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Individual</th>
                                <th>{{ view_objects.scoreboard.team }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for p in view_objects.scoreboard.user_team_standings %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ p.name }}</td>
                                <td>{{ p.current_round_points }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="item">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>{{ TEAM_LABEL.capitalize }}</th>
                                <th>Participation</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for f in view_objects.scoreboard.team_participation %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ f }}</td>
                                <td>{{ f.active_participation }}%</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
        {% if not view_objects.scoreboard.no_carousel %}
            </div>
            <div id="resource-scoreboard-message">#1 at end of round wins a
                <a href="/win"> prize!</a>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% if not view_objects.scoreboard.no_carousel %}
<script type="text/javascript">
    $(document).ready(function () {
    	  // Calculate the height of the items in the scoreboard.
    	  // Fix the height of all items to that height.
    	  var maxHeight = 45;
    	  var height = 0;
    	  $("#score-carousel .item").each(function(index, item) {
    	    height = $(item).height();
    	    // console.log("height of item is " + height);
    	    if (height > maxHeight){
    	      maxHeight = height;
    	    }
    	    maxHeight += $("#resource-scoreboard-message").height();
    	  });
    	  
    	  $("#score-carousel").height(maxHeight);

        $("#score-carousel").carousel();
    });
{% endif %}
</script>
