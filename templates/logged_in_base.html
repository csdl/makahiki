{% extends "base.html" %}

{% load class_tags %}
{% load generic_flatblocks %}
{% load markup %}

{% block extra_head_base %}
  {% import_logged_in_css STATIC_URL %}
  {% block extra_head %}{% endblock %}
{% endblock %}

{% block header %}

<div style="margin-top: 10px">
  <div {% get_id_and_classes "header-logout" %}>
    <a href="/account/cas/logout/">Logout</a>
  </div>

  <div {% get_id_and_classes "header-logo" %}>
    <a href="{% url home_index %}"><img src="{{STATIC_URL}}css/default/images/logo.png" title="Home"/></a>
  </div>

  <div {% get_id_and_classes "header-info" %}>
    {% include "components/user_info.html" %}
  </div>  
  
  <div {% get_id_and_classes "header-nav" %}>
    {% include "components/navigation.html" %}
  
    <div {% get_id_and_classes "header-title" %}>
      <h3>{% block page_title %}{% endblock %}</h3>
    </div>  
    
  </div>
</div>

{% if QUESTS %}
<div id="quest-box" class="content-box">
  <div class="content-box-title">Your Quests</div>
  
  <ul>
    {% for quest in QUESTS %}
    <li>
      <a href="#" class="quest-title">{{quest.name}}</a>
      <div class="quest-description" style="display:none">
        {{quest.description|markdown}}
        <div class="quest-options" style="float: right">
          <a href="#" style="margin-right: 20px">I accept this quest</a>
          <a href="#">I am not interested in this quest</a>
        </div>
        <div style="clear:both"></div>
      </div>
    </li>
    {% endfor %}
  </ul>
  
  <div id="quest-details" style="margin: 0px 10px">
    <a href="#" id="quest-hide" style="float: right; display: block">Hide</a>
    <div id="quest-contents" style="clear:both"></div>
  </div>
  
  <script type="text/javascript">
    $(document).ready(function() {
      // Hide the details until someone clicks on it.
      $("#quest-details").hide();
      
      // Handler for clicking a quest title.
      $(".quest-title").click(function() {
        //Set the title as selected if it is not already selected
        if (!$(this).parent().hasClass("selected")) {
          $(this).parent().siblings("li").removeClass("selected");
          $(this).parent().addClass("selected");
        }
        
        //Insert the contents of the quest-description into the details.
        $("#quest-contents").html($(this).next(".quest-description").html());
        
        //Toggle quest-details if it is hidden.
        if (!$("#quest-details").is(":visible")) {
          $("#quest-details").slideDown("slow", function() {
            //Animation complete
          });
        }
      });
      
      // Handler for clicking on the hide link.
      $("#quest-hide").click(function() {
        $("#quest-box li").removeClass("selected");
        $("#quest-details").slideUp("slow", function() {
          //Animation complete
        });
      });
    })
  </script>
</div>

{% endif %}
{# {% if help_info and user.get_profile.enable_help %} #}
{#   <div {% get_id_and_classes "notification" %}>  #}
{#     <div {% get_id_and_classes "notification-box" %}> #}
{#       Help Topics:  #}
{#       <ul {% get_id_and_classes "help-topics" %}> #}
{#       {% for number in help_info.count %} #}
{#         {% gblock help_info.prefix,number for "gblocks.TitleAndText" into "block_object" %} #}
{#         <li> #}
{#           <a id="help-title-{{number}}" href="#" onclick='$("#help-dialog-{{number}}").dialog("open"); return false;'> #}
{#           {% if block_object.title %} #}
{#             {{block_object.title}} #}
{#           {% else %} #}
{#             No title #}
{#           {% endif %} #}
{#           </a> #}
{#         </li> #}
{#       {% endfor %} #}
{#       </ul> #}
{#       <div {% get_id_and_classes "help-page" %}> #}
{#         {% gblock help_info.prefix for "gblocks.Text" with "help/page_help/help_box.html" %} #}
{#       </div> #}
{#     </div> #}
{#     <a href="#" onclick="$('#notification-box').fadeOut(); return false;"> #}
{#       <span style="margin-top: 1px; float:right" class="ui-icon ui-icon-close"></span> #}
{#     </a> #}
{#   </div> #}
{# {% endif %} #}


{% endblock %}

{% block extra_body %}
<script type="text/javascript">
jQuery(document).ready(function(){
    jQuery('a.frontendadmin_edit').hover(
        function(){jQuery(this).parent().css('outline', '4px solid #E9B007')},
        function(){jQuery(this).parent().css('outline', '')}
    );
    
    jQuery('a.frontendadmin_edit').click(function(){
            jQuery(this).parent().css('outline', '');
            jQuery(this).parent().load(this.href);
            return false;
    });
    
    jQuery('a.frontendadmin_delete').hover(
        function(){jQuery(this).parent().css('outline', '4px solid #E9B007')},
        function(){jQuery(this).parent().css('outline', '')}
    );
});
</script>

{% if help_info and user.get_profile.enable_help %}
  {% for number in help_info.count %}
  {% gblock help_info.prefix,number for "gblocks.TitleAndText" with "help/page_help/help_dialog.html" %}
  
  <script type="text/javascript"> 
    $(document).ready(function() {
      $("#help-dialog-{{number}}").dialog({
          modal: true,
          autoOpen: false
      });
    })
  </script>  
  {% endfor %}
{% endif %}

{% endblock %}