{% extends "makahiki_profiles/base.html" %}

{% load generic_flatblocks %}

{% block tab_id %}"#profile_tab"{% endblock %}

{% block extra_head %}
  <script type="text/javascript">
    jQuery(document).ready(function() {
      jQuery(".item_description").hide();
      
      jQuery(".item_title a").click(function() {
        var icon = jQuery(this).children(".toggle-icon");
        
        if (icon.hasClass("ui-icon-plus")) {
          icon.addClass("ui-icon-minus");
          icon.removeClass('ui-icon-plus');
        }
        else {
          icon.addClass("ui-icon-plus");
          icon.removeClass('ui-icon-minus');
        }
        jQuery(this).parent().next(".item_description").toggle("blind");
      });
    });
  </script>
{% endblock %}

{% block body %}
  <h2 id="list_header">{{item_name.capitalize}}</h2>
  <div id="user_items" class="list_item ui-corner-all ui-accordion ui-widget ui-accordion-icons">
    <div class="ui-accordion-header ui-corner-top ui-state-default activity_header">
      Active {{item_name}}:
      <span id="active_help" class="list-help ui-icon ui-icon-help"></span>
    </div>

    <div class="list_content ui-accordion-content ui-widget-content ui-corner-bottom ui-accordion-content-active">
      {% if user_items %}
        <table class="activity_list">
        <tr class="column_header">
          <td class="activity_title">Title</td>
          <td class="activity_points">Points</td>
          <td class="activity_options">Options</td>
        </tr>
          {% for item in user_items %}
            {% include "activities/item.html" %}
          {% endfor %}
        </table>
      {% else %}
        <h4>You are not participating in any {{item_name}}.</h4>
      {% endif %}
    </div>
  </div>

  <div id="available_items" class="list_item ui-corner-all ui-accordion ui-widget ui-accordion-icons">
    <div class="ui-accordion-header ui-corner-top ui-state-default activity_header">
      Available {{item_name}}:
      <span id="available_help" class="list-help ui-icon ui-icon-help"></span>
    </div>

    <div class="activity_content ui-accordion-content ui-widget-content ui-corner-bottom ui-accordion-content-active">
      <table class="activity_list">
      <tr class="column_header">
        <td class="activity_title">Title</td>
        <td class="activity_points">Points</td>
        <td class="activity_options">Options</td>
      </tr>
        {% for item in available_items %}
          {% include "activities/item.html" %}
        {% endfor %}
      </table>
  </div>
{% endblock %}

{% block extra_body %}
  <!-- Dialogs -->
  <script type="text/javascript">
    jQuery(document).ready(function() {
      jQuery("#active_dialog").dialog({autoOpen: false, modal: true});
      jQuery("#available_dialog").dialog({autoOpen: false, modal: true});

      jQuery('#active_help').click(function() {
        jQuery('#active_dialog').dialog('open');
        return false;
      });
      
      jQuery('#available_help').click(function() {
        jQuery('#available_dialog').dialog('open');
        return false;
      });
    })
  </script>
  
  <div id="active_dialog" title="Active {{item_name.capitalize}}">
    {% gblock "active",item_name for "gblocks.Text" with "activities/gblocks/help.html" %}
  </div>
  <div id="available_dialog" title="Available {{item_name.capitalize}}">
    {% gblock "available",item_name for "gblocks.Text" with "activities/gblocks/help.html" %}
  </div>
{% endblock %}