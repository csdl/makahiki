{% extends "makahiki_profiles/base.html" %}

{% load generic_flatblocks %}
{% load activity_tags %}

{% block extra_head %}
  <script type="text/javascript">
    jQuery(document).ready(function() {
      jQuery(".item_description").hide();
      
      jQuery(".item_title a").click(function() {
        var icon = jQuery(this).children(".toggle-icon");
        
        if (icon.hasClass("ui-icon-plus")) {
          icon.addClass("ui-icon-minus");
          icon.removeClass('ui-icon-plus');
        }
        else {
          icon.addClass("ui-icon-plus");
          icon.removeClass('ui-icon-minus');
        }
        jQuery(this).parent().parent().children(".item_description").toggle("blind");
      });
    });
    
    function confirm_removal(form, item_type) {
      var confirmed = confirm("Are you sure you wish to remove this " + item_type + "?");
      if (confirmed) {
        form.submit();
        return true;
      }
      else {
        return false;
      }
    }
  </script>
{% endblock %}

{% block active_subnav %}{{plural_type}}{%endblock%}

{% block body %}
  <div id="main_content" style="float: left; width: 67%">
  
    <div id="user_items" class="main_list ui-corner-all ui-accordion ui-widget ui-accordion-icons">
      <div class="ui-accordion-header ui-corner-top ui-state-default list_header">
        {% if plural_type == "activities" %}
          Submitted {{plural_type}}:
        {% else %}
          Active {{plural_type}}:
        {% endif %}
        <span id="active_help" class="list-help ui-icon ui-icon-help"></span>
      </div>

      <div class="activity_content ui-accordion-content ui-widget-content ui-corner-bottom ui-accordion-content-active">
        {% if user_items %}
          <table class="activity_list">
          <tr class="column_header">
            <td class="item_info">Title</td>
            <td class="item_points">Points</td>
            <td class="item_options">Options</td>
          </tr>
            {% for item in user_items %}
              {% include "activities/item.html" %}
            {% endfor %}
          </table>
        {% else %}
          {% if plural_type == "activities" %}
            You have not submitted any activities.
          {% else %}
            <h4>You are not participating in any {{plural_type}}.</h4>
          {% endif %}
        {% endif %}
      </div>
    </div>
    
    <div id="available_items" class="main_list ui-corner-all ui-accordion ui-widget ui-accordion-icons">
      <div class="ui-accordion-header ui-corner-top ui-state-default list_header">
        Available {{plural_type}}:
        <span id="available_help" class="list-help ui-icon ui-icon-help"></span>
      </div>

      <div class="activity_content ui-accordion-content ui-widget-content ui-corner-bottom ui-accordion-content-active">
        <table class="activity_list">
        <tr class="column_header">
          <td class="item_info">Title</td>
          <td class="item_points">Points</td>
          <td class="item_options">Options</td>
        </tr>
          {% for item in available_items %}
            {% include "activities/item.html" %}
          {% endfor %}
        </table>
      </div>
    </div>
  </div>
  
  <div id="side_content" style="float:right; width: 30%; padding-right: 10px">
    <div id="completed_items" class="side_list ui-corner-all ui-accordion ui-widget ui-accordion-icons">
      <div class="ui-accordion-header ui-corner-top ui-state-default list_header">
        Completed {{plural_type}}:
        <span id="completed_help" class="side-help ui-icon ui-icon-help"></span>
      </div>

      <div class="list_content ui-accordion-content ui-widget-content ui-corner-bottom ui-accordion-content-active">
      {% if completed_items %}
      <ul style="list-style: none; margin: 0; padding: 0">
        {% for item in completed_items %}
          {% include "activities/side_item.html" %}
        {% endfor %}
      </ul>
      {% else %}
        <h4>You have not completed any {{plural_type}}.</h4>
      {% endif %}
      </div>
    </div>
  </div>
{% endblock %}

{% block extra_body %}
  <!-- Dialogs -->
  <script type="text/javascript">
    jQuery(document).ready(function() {
      jQuery("#active_dialog").dialog({autoOpen: false, modal: true});
      jQuery("#available_dialog").dialog({autoOpen: false, modal: true});
      jQuery("#completed_dialog").dialog({autoOpen: false, modal: true});

      jQuery('#active_help').click(function() {
        jQuery('#active_dialog').dialog('open');
        return false;
      });
      
      jQuery('#available_help').click(function() {
        jQuery('#available_dialog').dialog('open');
        return false;
      });
      
      jQuery('#completed_help').click(function() {
        jQuery('#completed_dialog').dialog('open');
        return false;
      });
    })
  </script>
  
  <div id="active_dialog" title="Active {{plural_type.capitalize}}">
    {% gblock "active",plural_type for "gblocks.Text" with "activities/gblocks/help.html" %}
  </div>
  <div id="available_dialog" title="Available {{plural_type.capitalize}}">
    {% gblock "available",plural_type for "gblocks.Text" with "activities/gblocks/help.html" %}
  </div>
  <div id="completed_dialog" title="Completed {{plural_type.capitalize}}">
    {% gblock "completed",plural_type for "gblocks.Text" with "activities/gblocks/help.html" %}
  </div>
{% endblock %}