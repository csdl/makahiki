<script type="text/javascript" src="http://wattdepot-gdata.googlecode.com/svn/trunk/javascript/org.wattdepot.gdata.GDataLoader.js"></script>
<script type="text/javascript" src="http://wattdepot-gdata.googlecode.com/svn/trunk/javascript/org.wattdepot.gdata.kukuicup.Configuration.js"></script>
<script type="text/javascript" src="http://wattdepot-gdata.googlecode.com/svn/trunk/javascript/org.wattdepot.gdata.makahiki.Standings.js"></script>
<script type="text/javascript">
	$(function() {
		$("#tabs").tabs({ selected: {{standings.selected_tab}} });
	});
</script>

<div id="tabs" class="activity_item">
  <ul>
		{% for title in standings.standings_titles %}
		  <li>
		  {% if forloop.last %}
		    <a href="#overall_standings" style="font-weight: normal">{{title}}</a>
		  {% else %}
		    <a href="#round_standings_{{forloop.counter}}" style="font-weight: normal">{{title}}</a>
		  {% endif %}
		  </li>
		{% endfor %}
	</ul>

  {% for standings in standings.user_standings %}
    {% if forloop.last %}
      <div id="overall_standings">
        <div id="floor_overall_standings" style="float:left"></div>
        <div id="all_overall_standings" style="float:right"></div>
        <div style="clear:both"></div>
      </div>
      <script type="text/javascript">
      // Wrap this code in an anonymous self-invoking function to avoid polluting global namespace.
      (function() {
        // This data structure must be generated by Makahiki.
        var floorStandings = {{standings.floor|safe}};
        var allStandings = {{standings.all|safe}}

        // Load the visualization API, then call displayDormData.
        var floorLoader = new org.wattdepot.gdata.GDataLoader(displayFloorStandings); 
        var allLoader = new org.wattdepot.gdata.GDataLoader(displayAllStandings);  

        function displayFloorStandings() {
          var configuration = new org.wattdepot.gdata.kukuicup.Configuration();
          var standingsChart = new org.wattdepot.gdata.makahiki.Standings(configuration);
          standingsChart.setWidth(240);
          standingsChart.draw('floor_overall_standings', floorStandings);
        }
        
        function displayAllStandings() {
          var configuration = new org.wattdepot.gdata.kukuicup.Configuration();
          var standingsChart = new org.wattdepot.gdata.makahiki.Standings(configuration);
          standingsChart.setWidth(240);
          standingsChart.draw('all_overall_standings', allStandings);
        }
      })();
      </script>
    {% else %}
      <div id="round_standings_{{forloop.counter}}">
        <div id="floor_standings_{{forloop.counter}}" style="float:left"></div>
        <div id="all_standings_{{forloop.counter}}" style="float:right"></div>
        <div style="clear:both"></div>
      </div>
      <script type="text/javascript">
      // Wrap this code in an anonymous self-invoking function to avoid polluting global namespace.
      (function() {
        // This data structure must be generated by Makahiki.
        var floorStandings = {{standings.floor|safe}};
        var allStandings = {{standings.all|safe}}

        // Load the visualization API, then call displayDormData.
        var floorLoader = new org.wattdepot.gdata.GDataLoader(displayFloor{{forloop.counter}}Standings);
        var allLoader = new org.wattdepot.gdata.GDataLoader(displayAll{{forloop.counter}}Standings);  

        function displayFloor{{forloop.counter}}Standings() {
          var configuration = new org.wattdepot.gdata.kukuicup.Configuration();
          var standingsChart = new org.wattdepot.gdata.makahiki.Standings(configuration);
          standingsChart.setWidth(240);
          standingsChart.draw('floor_standings_{{forloop.counter}}', floorStandings);
        }
        
        function displayAll{{forloop.counter}}Standings() {
          var configuration = new org.wattdepot.gdata.kukuicup.Configuration();
          var standingsChart = new org.wattdepot.gdata.makahiki.Standings(configuration);
          standingsChart.setWidth(240);
          standingsChart.draw('all_standings_{{forloop.counter}}', allStandings);
        }
      })();
      </script>
    {% endif %}
  {% endfor %}
</div>
